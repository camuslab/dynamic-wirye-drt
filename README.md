# Dynamic Wirye DRT Simulation

μ„λ΅€ μ‹ λ„μ‹ μ§€μ—­μ„ κΈ°λ°μΌλ΅ ν• λ™μ  μμ”μ‘λ‹µν• κµν†µ(DRT) μ‹λ‚λ¦¬μ¤ μ‹λ®¬λ μ΄μ… ν”„λ΅μ νΈμ…λ‹λ‹¤.  
λ³Έ ν”„λ΅μ νΈλ” λ¨λ“ν™”λ Python μ—”μ§„μ„ ν†µν•΄ λ°°μ°¨ μ•κ³ λ¦¬μ¦, κ²½λ΅ νƒμƒ‰(OSRM), λ¦¬λ°Έλ°μ‹± μ •μ±…μ„ μ‹λ®¬λ μ΄μ…ν•κ³ , React κΈ°λ°μ λ€μ‹λ³΄λ“λ¥Ό ν†µν•΄ κ²°κ³Όλ¥Ό μ‹κ°μ μΌλ΅ λ¶„μ„ν•©λ‹λ‹¤.

---

## π€ μ£Όμ” κΈ°λ¥
- **λ¨λ“ν• μ—”μ§„**: μ„¤μ •, λ΅μ§, λ¨λΈ, I/Oκ°€ λ¶„λ¦¬λμ–΄ μμ–΄ ν™•μ¥μ΄ μ©μ΄ν•©λ‹λ‹¤.
- **μ‹¤μ  λ„λ΅ κΈ°λ° λΌμ°ν…**: OSRM(Open Source Routing Machine)μ„ μ—°λ™ν•μ—¬ μ§μ„ κ±°λ¦¬κ°€ μ•„λ‹ μ‹¤μ  λ„λ΅ μ •λ³΄λ¥Ό λ°μν•©λ‹λ‹¤.
- **λ‹¤μ–‘ν• μ§€ν‘ λ¶„μ„**: λ€κΈ°μ‹κ°„, μ°νμ¨, μ„±κ³µλ¥ , μ μ¬μ¨ λ“± ν•µμ‹¬ μ„±λ¥ μ§€ν‘(KPI)λ¥Ό μλ™μΌλ΅ μ‚°μ¶ν•©λ‹λ‹¤.
- **μΈν„°λ™ν‹°λΈ μ‹κ°ν™”**: Deck.glμ„ μ‚¬μ©ν•μ—¬ μ°¨λ‰μ μ‹¤μ‹κ°„ μ΄λ™ λ° μΉκ° μƒνƒλ¥Ό μ§€λ„μƒμ— μ‹κ°ν™”ν•©λ‹λ‹¤.

---

## π“ λ””λ ‰ν„°λ¦¬ κµ¬μ΅°

- `main.py`: μ‹λ®¬λ μ΄μ… ν†µν•© μ‹¤ν–‰ μ—”νΈλ¦¬ν¬μΈνΈ 
- `module/`: ν•µμ‹¬ λ΅μ§ ν¨ν‚¤μ§€
  - `config/`: μ‹λ®¬λ μ΄μ… νλΌλ―Έν„° λ° κ²½λ΅ μ„¤μ • (`config.py`)
  - `engine/`: λ°°μΉ μ²λ¦¬ λ° μ΄λ²¤νΈ λ£¨ν”„ μ—”μ§„
  - `dispatch/`: μ°¨λ‰-μμ” λ§¤μΉ­ λ° μ‚½μ… λ΅μ§
  - `routing/`: OSRM ν΄λΌμ΄μ–ΈνΈ λ° κ²½λ΅ μ¶”μ  μ ν‹Έ
  - `io/`: λ°μ΄ν„° λ΅λ” λ° κ²°κ³Όλ¬Ό Export
  - `make_viz_json.ipynb`: μ›λ³Έ κ²°κ³Όλ¬Όμ„ μ›Ή μ‹κ°ν™”μ© JSONμΌλ΅ λ³€ν™ν•λ” λ…ΈνΈλ¶
- `data/`: μ…λ ¥ λ°μ΄ν„° (Parquet ν•μ‹)
- `outputs/`: μ‹λ®¬λ μ΄μ… κ²°κ³Όλ¬Ό (`summary`, `events`, `tracks` λ“±)
- `κ²°κ³Όλ¶„μ„/`: μ‹λ‚λ¦¬μ¤λ³„ μ„±λ¥ λΉ„κµ λ° λ¶„μ„μ© λ…ΈνΈλ¶ ν΄λ”
- `react-project/`: Deck.gl κΈ°λ° μ‹κ°ν™” ν”„λ°νΈμ—”λ“

---

## π› οΈ μ„¤μΉ λ° μ‹¤ν–‰ λ°©λ²•

### 1. Python ν™κ²½ μ„¤μ • (Backend)
- **μ”κµ¬μ‚¬ν•­**: Python 3.10+
- **κ°€μƒν™κ²½ ν™μ„±ν™” λ° ν¨ν‚¤μ§€ μ„¤μΉ**:
  ```bash
  source venv/bin/activate  # Mac/Linux
  pip install -r requirements.txt
  ```
- **ν•„μ μ„λΉ„μ¤**: OSRM μ„λ²„κ°€ **ν¬νΈ 8000**μ—μ„ μ‹¤ν–‰ μ¤‘μ΄μ–΄μ•Ό ν•©λ‹λ‹¤ (Docker κ¶μ¥).

### 2. μ‹λ®¬λ μ΄μ… μ‹¤ν–‰
1. `module/config/config.py`μ—μ„ `fleet_size`, `RUN_TAG` λ“±μ νλΌλ―Έν„°λ¥Ό μ„¤μ •ν•©λ‹λ‹¤.
2. λ©”μΈ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤:
   ```bash
   python main.py
   ```
3. `outputs/<RUN_TAG>/` ν΄λ”μ— κ²°κ³Ό μ½”λ“κ°€ μƒμ„±λ©λ‹λ‹¤.

### 3. λ°μ΄ν„° μ „μ²λ¦¬ (Visualization μ¤€λΉ„)
- `module/make_viz_json.ipynb` λ…ΈνΈλ¶μ„ μ‹¤ν–‰ν•μ—¬ `outputs/`μ κ²°κ³Όλ¬Όμ„ `react-project/public/data/`λ΅ λ³€ν™/λ³µμ‚¬ν•©λ‹λ‹¤.
- μ΄ κ³Όμ •μ—μ„ `trip.json`, `pax_icon.json` λ“±μ΄ μƒμ„±λ©λ‹λ‹¤.

### 4. μ‹κ°ν™” λ€μ‹λ³΄λ“ (Frontend)
- **μ”κµ¬μ‚¬ν•­**: Node.js 18+
- **μ‹¤ν–‰**:
  ```bash
  cd react-project
  npm install
  npm run dev
  ```
- λΈλΌμ°μ €μ—μ„ `http://localhost:5173` μ ‘μ† ν›„ μ°¨λ‰ λ€μλ¥Ό μ„ νƒν•μ—¬ μ‹κ°ν™”λ¥Ό ν™•μΈν•©λ‹λ‹¤.

---

## π“ μ„¤μ • λ° λ¶„μ„

### μ£Όμ” νλΌλ―Έν„° (`module/config/config.py`)
| νλΌλ―Έν„° | μ„¤λ… | κΈ°λ³Έκ°’ |
| :--- | :--- | :--- |
| `fleet_size` | ν¬μ… μ°¨λ‰ λ€μ | 50 |
| `pickup_late_sec` | μµλ€ λ€κΈ° ν—μ© μ‹κ°„ | 600s (10λ¶„) |
| `detour_ratio_max` | μµλ€ ν—μ© μ°νμ¨ | 2.0 |
| `max_retries` | λ°°μ°¨ μ¬μ‹λ„ νμ | 2 |

### κ²°κ³Ό λ¶„μ„
- `κ²°κ³Όλ¶„μ„/μ„±λ¥ν‰κ°€μ§€ν‘.ipynb`λ¥Ό ν†µν•΄ μ—¬λ¬ μ‹λ‚λ¦¬μ¤(10λ€, 20λ€, 50λ€ λ“±)μ μ„±λ¥μ„ ν•λμ— λΉ„κµν•  μ μμµλ‹λ‹¤.

---

## β οΈ λ¬Έμ  ν•΄κ²° (Troubleshooting)
- **OSRM μ—°κ²° μ¤λ¥**: Docker μΈμ¤ν„΄μ¤κ°€ ν™μ„±ν™”λμ–΄ μλ”μ§€, ν¬νΈκ°€ `8000`μΌλ΅ λ§¤ν•‘λμ–΄ μλ”μ§€ ν™•μΈν•μ„Έμ”.
- **μ„±λ¥ μ €ν•**: μ°¨λ‰ λ€μκ°€ λ§μ„ κ²½μ° `context_mapping.py`μ—μ„ ν›„λ³΄κµ° μƒν”λ§ λ΅μ§μ„ λ‹¤μ‹ ν™μ„±ν™”ν•  μ μμµλ‹λ‹¤.
- **λ°μ΄ν„° κ²½λ΅**: Parquet νμΌμ΄ `data/processed/` ν΄λ” λ‚΄μ— μ΅΄μ¬ν•λ”μ§€ ν™•μΈν•μ„Έμ”.

---
Β© 2025 Dynamic Wirye DRT Project.
